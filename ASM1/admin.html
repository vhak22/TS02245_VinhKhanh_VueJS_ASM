<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>Admin - Galaxy Blog</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Vue -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <style>
        body {
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            min-height: 100vh;
            color: white;
            font-family: 'Segoe UI', sans-serif;
        }

        .navbar {
            background: rgba(15, 12, 41, 0.6);
            backdrop-filter: blur(10px);
        }

        .admin-box {
            background: rgba(255, 255, 255, 0.06);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 0 30px rgba(127, 90, 240, 0.3);
        }

        .form-control {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
        }

        .form-control::placeholder {
            color: #ccc;
        }

        table th,
        table td {
            vertical-align: middle;
        }

        .btn-galaxy {
            background: linear-gradient(135deg, #7f5af0, #00f5d4);
            border-radius: 30px;
            border: none;
            color: white;
            padding: 6px 18px;
            transition: 0.4s;
        }

        .btn-galaxy:hover {
            box-shadow: 0 0 20px #7f5af0;
            transform: scale(1.05);
        }
    </style>
</head>

<body>
    <div id="app">

        <!-- NAVBAR -->
        <nav class="navbar navbar-expand-lg fixed-top">
            <div class="container">
                <span class="navbar-brand text-white fw-bold">üõ† Admin Panel</span>
                <button class="btn btn-danger btn-sm" @click="logout">Logout</button>
            </div>
        </nav>

        <!-- CONTENT -->
        <div class="container" style="padding-top:120px;">
            <div class="admin-box">

                <h3 class="mb-4">Qu·∫£n l√Ω b√†i vi·∫øt</h3>

                <!-- FORM -->
                <div class="row mb-4">
                    <div class="col-md-4">
                        <input v-model="form.title" class="form-control mb-2" placeholder="Ti√™u ƒë·ªÅ">
                    </div>
                    <div class="col-md-4">
                        <input v-model="form.author" class="form-control mb-2" placeholder="T√°c gi·∫£">
                    </div>
                    <div class="col-md-4">
                        <input v-model="form.desc" class="form-control mb-2" placeholder="M√¥ t·∫£">
                    </div>
                    <div class="col-12">
                        <textarea v-model="form.content" class="form-control mb-3" rows="3"
                            placeholder="N·ªôi dung"></textarea>
                        <button class="btn btn-galaxy" @click="savePost">
                            {{ isEdit ? 'C·∫≠p nh·∫≠t' : 'Th√™m b√†i vi·∫øt' }}
                        </button>
                    </div>
                </div>

                <!-- TABLE -->
                <table class="table table-dark table-hover">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Ti√™u ƒë·ªÅ</th>
                            <th>T√°c gi·∫£</th>
                            <th>H√†nh ƒë·ªông</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="(p, index) in posts" :key="p.id">
                            <td>{{ index + 1 }}</td>
                            <td>{{ p.title }}</td>
                            <td>{{ p.author }}</td>
                            <td>
                                <button class="btn btn-warning btn-sm me-2" @click="editPost(p)">Edit</button>
                                <button class="btn btn-danger btn-sm" @click="deletePost(p.id)">Delete</button>
                            </td>
                        </tr>
                    </tbody>
                </table>

            </div>
        </div>

    </div>

    <!-- Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Vue -->
    <script>
        const app = Vue.createApp({
            data() {
                return {
                    posts: JSON.parse(localStorage.getItem("posts")) || [],
                    form: {
                        id: null,
                        title: "",
                        author: "",
                        desc: "",
                        content: ""
                    },
                    isEdit: false
                }
            },
            mounted() {
                const user = JSON.parse(localStorage.getItem("currentUser"));
                if (!user || user.role !== "admin") {
                    alert("B·∫°n kh√¥ng c√≥ quy·ªÅn truy c·∫≠p!");
                    window.location.href = "login.html";
                }
            },
            methods: {
                savePost() {
                    if (!this.form.title || !this.form.author) {
                        alert("Vui l√≤ng nh·∫≠p ƒë·ªß th√¥ng tin");
                        return;
                    }

                    if (this.isEdit) {
                        const index = this.posts.findIndex(p => p.id === this.form.id);
                        this.posts[index] = { ...this.form };
                        this.isEdit = false;
                    } else {
                        this.form.id = Date.now();
                        this.posts.push({ ...this.form });
                    }

                    localStorage.setItem("posts", JSON.stringify(this.posts));
                    this.resetForm();
                },
                editPost(post) {
                    this.form = { ...post };
                    this.isEdit = true;
                },
                deletePost(id) {
                    if (confirm("X√≥a b√†i vi·∫øt?")) {
                        this.posts = this.posts.filter(p => p.id !== id);
                        localStorage.setItem("posts", JSON.stringify(this.posts));
                    }
                },
                resetForm() {
                    this.form = { id: null, title: "", author: "", desc: "", content: "" };
                },
                logout() {
                    localStorage.removeItem("currentUser");
                    window.location.href = "login.html";
                }
            }
        });

        app.mount("#app");
    </script>
</body>

</html>